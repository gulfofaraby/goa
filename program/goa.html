<!DOCTYPE html>
<html>
<head>
  <style>body{color:white; background-color:black;} p{color:white; font-size:48px; font-type:"Courier New"; margin:.1em;}</style>
  <style> .container{position:relative; float:left; width:800px; margin:0px; padding:0px; display:flex; align-items:center; justify-content:center;} .text-block {position:absolute; background:rgb(0,0,0); background:rgba(0,0,0,0.7); color: white; padding-left:15px; padding-right:15px; margin:0px; /* padding-left: 10px; padding-right: 10px; */ }</style>
  <script src="../jspsych.js"></script>
  <script src="../plugins/jspsych-animation.js"></script>
  <script src="../plugins/jspsych-html-keyboard-response.js"></script>
  <script src="../plugins/jspsych-image-keyboard-response.js"></script>
  <link rel="stylesheet" href="../css/jspsych.css"></link>
</head>
<script>
  const picPath = '../docs/img_goa/';
  var step;  
  var picsB = [];
  for (step = 0; step < 2; step++) 
    picsB.push(picPath.concat('b', step, '.jpg'));
  var picsL = [];
  for (step = 0; step < 24; step++) 
    picsL.push(picPath.concat('l', step, '.jpg'));
  var picsP = [];
  for (step = 0; step < 24; step++) 
    picsP.push(picPath.concat('p', step, '.jpg'));
  var picsS = [];
//  for (step = 0; step < 8; step++) 
//    picsS.push(picPath.concat('s', step, '.jpg'));
  var picsV = [];
  for (step = 0; step < 11; step++) 
    picsV.push(picPath.concat('v', step, '.jpg'));
  const picsA = picsB.concat(picsL, picsP, picsS, picsV);

  var displayContent = [
    {bg:'black0.jpg', text:'simply focus and relax'},
    {bg:'spiral1.gif', text:'simply focus and relax'},
    {},
    {text:'just breathe in'},
    {},
    {text:'and breathe out'},
    {},
    {text:' breathe in'},
    {},
    {text:'and breathe out'},
    {},
    {text:'breathe in'},
    {text:'and focus'},
    {},
    {text:'and breathe out'},
    {text:'and relax'},
    {},
    {text:'simply breathe'},
    {},
    {text:'and focus'},
    {},
    {text:'       as you relax       ', dur: 1000},
    {text:'       as you focus       ', dur: 333},
    {text:'       as you relax deeper', dur: 667},
    {dur: 10000},
    {bg: 'spiral0.gif', dur: 750},
    {bg: 'spiral1.gif', text:'relax. breathe. focus.'},
    {bg: 'spiral0.gif', dur: 500},
    {bg: 'spiral1.gif', dur: 750},
    {bg: 'spiral0.gif'},
    {text:'  it\'s  good  to  relax  ', dur: 800},
    {text:'        good      relax  ', dur: 300},
    {text:'      a good girl relaxes', dur: 500},
    {text:'  it\'s  good  to  relax  ', dur: 500},
    {},
    {text:'breathe. focus. relax.'},
    {},
    {text:'         it\'s  relaxing  to  focus         '},
    {text:'               relax         focus         ', dur: 150},
    {text:'  good girl,   relax   and   focus         ', dur: 400},
    {text:'  good girl    relax         focus         ', dur: 150},
    {text:'a good girl is relaxed  and  focused       ', dur: 400},
    {text:'         it\'s  relaxing  to  focus         ', dur: 600},
    {dur: 5000},
    {text:'           it\'s  good  to  focus  and  relax           ', dur: 1450},
    {text:'                 good girl focus  and  relax           ', dur: 400},
    {text:'                 good girl                             ', dur: 150},
    {text:'you want to be a good girl                             ', dur: 400},
    {text:'                                                       ', dur: 50},
    {text:'               you want to be a good girl              ', dur: 150},
    {dur: 1500},
    {bg:'spiral1.gif', text:' breathe       focus       relax  '},
    {bg:'spiral0.gif', text:'a good girl is focused and relaxed', dur: 300},
    {text:' breathe       focus       relax  ', dur: 200},
    {text:'a good girl is focused and relaxed', dur: 1800},
    {text:' breathe       focus       relax  ', dur: 200},
    {text:'a good girl is focused and relaxed', dur: 500},
    {text:'  good girl                       ', dur: 100},
    {text:'                                  ', dur: 100},
    {text:'  good girl                       ', dur: 700},
    {text:'                                  ', dur: 100},
    {},
    {text:'you want to be a good girl', dur: 800},
    {text:'                          ', dur: 200},
    {text:'you want to be a good girl', dur: 300},
    {bg: 'v3.jpg', dur: 300},
    {bg: 'p18_c.jpg', dur: 300},
    {bg: 'p21.jpg', dur: 300},
    {bg: 'l11_c.jpg', dur: 300},
    {bg:'spiral0.gif', text:'you want to be a good girl', dur: 800},
    {dur: 3000},
    {text:'you\'d like to relax much deeper', dur: 1200},
    {bg: 'p18_c.jpg', text:'you\'d like to relax much deeper', dur: 400},
    {bg: 'spiral0.gif', text:'you\'d like to relax much deeper', dur: 400},
    {dur: 3000},
    {text: 'the next exercise will help you relax much deeper'},
    {dur: 3000},
    {text: 'breathe and watch closely'},
    {},
    {text: 'simply breathe and focus and watch and relax'},
    {},
    {bg: 'black0.jpg'}
  ];
  
  var displayTrials = [];
  var dispBG = 'black0.jpg';
  displayContent.forEach(function(dispCont) {
    if (dispCont.bg != null) {
      dispBG = dispCont.bg;
    }
    if (dispCont.text == null && dispCont.dur == null) {
      displayTrials.push({stimulus: '<div class="container"><img src="../docs/img_goa/' + dispBG + '" style="width:100%;"></div>'});
    } else if (dispCont.text == null) {
      displayTrials.push({stimulus: '<div class="container"><img src="../docs/img_goa/' + dispBG + '" style="width:100%;"></div>', trial_duration: dispCont.dur});
    } else if (dispCont.dur == null) {
      displayTrials.push({stimulus: '<div class="container"><img src="../docs/img_goa/' + dispBG + '" style="width:100%;"><div class="text-block"><p><pre>' + dispCont.text + '</pre></p></div></div>'});
    } else {
      displayTrials.push({stimulus: '<div class="container"><img src="../docs/img_goa/' + dispBG + '" style="width:100%;"><div class="text-block"><p><pre>' + dispCont.text + '</pre></p></div></div>', trial_duration: dispCont.dur});
    }
  });
  
  var block1 = {
    type: 'html-keyboard-response',
    choices: jsPsych.NO_KEYS,
    trial_duration: 2000,
    timeline: displayTrials,
  };
  
  var block2_strobe = {
    type: 'animation',
    stimuli: jsPsych.randomization.sampleWithoutReplacement(picsL, 24),
    sequence_reps: 1,
    frame_time: 200,
  };
  
  var iti1 = {
    type: 'animation',
    stimuli: ['../docs/img_goa/pink0.jpg', '../docs/img_goa/s7.jpg', '../docs/img_goa/pink0.jpg', '../docs/img_goa/black0.jpg', '../docs/img_goa/black0.jpg', '../docs/img_goa/black0.jpg'],
    sequence_reps: 1,
    frame_time: 100,
  };
  
  var trial2 = {
    type: 'animation',
    stimuli: jsPsych.randomization.sampleWithoutReplacement(picsA, 30),
    sequence_reps: 1,
    frame_time: 100,
  };
  
  jsPsych.init({
    timeline: [block1, block2_strobe, iti1, trial2],
    on_finish: function() {
      jsPsych.data.displayData();
    }
  });
</script>

</html>
